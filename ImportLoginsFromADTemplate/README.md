# Импорт логинов из Active Directory
Шаблон кода для импорта логинов из Active Directory и синхронизации статуса учетных записей.

### Описание кейса, когда можно применить
Импорт логинов из AD для выполнения внешней аутентификации, в случае, когда список сотрудников и оргструктура уже импортированы или синхронизуются из внешней системы.

### Использование
1. Подключите к прикладному модулю внешнюю сборку ADSearch/ADSearch.dll.
2. Скопируйте серверные функции модуля из файла ModuleServerFunctions.cs.
3. Скопируйте логику фоновых процессов синхронизации в модуль проекта из файла ModuleJobs.cs.

В файле ModuleJobs.cs представлена логика для двух фоновых процеcсов:
 1. UpdateOrCreateLogins реализует синхронизацию учетных записей из Active Directory.
 2. CloseLogins реализует закрытие учетных записей.
 
Поиск записей в Active Directory производится по табельному номеру сотрудника.
При необходимости удаления сотрудников, администратор помещает сотрудника в специальный Organization Unit(OU). Этот OU задается в специальной настройке в таблице Sungero_Docflow_Params:
 - ADDelOU - наименование OU для удаляемых Сотрудников (строка). 
Конфигурация подключения к Active Directory хранится в таблице Sungero_Docflow_Params. При использовании на проекте необходимо либо адаптировать для использовать другого хранилища настроек, либо создать в таблице Sungero_Docflow_Params набор параметров:
 - ADHost - адрес сервера AD (строка).
 - ADDomain - домен, с которым будет выполняться взаимодействие (строка).
 - ADUserName - пользователь, от имени которого будет выполняться подключение к AD (строка).
 - ADUserPas - пароль для этого пользователя (строка).
 - ADPort - порт, для подключения к AD (строка).
 - ADUseSsl - переменная, которая определяет, будет ли использоваться SSL-шифрование при работе с AD (булевая переменная).
 
### Ограничения
Для получения данных из Active Directory используется подключаемая сборка ADSearch.dll.
Данные возвращаются функцией ExecuteQueryToAD в виде словаря. Перед получением данных необходимо определить ключ словаря NameOfDictionaryKey.

### Модификации
 - Вы можете изменить параметр синхронизации с Active Directory с табельного номера сотрудника на нужный вам параметр, например, на почту сотрудника.
 - Вы можете изменить конфигурацию подключения к Active Directory, место ее хранения и способ получения. Например, брать данные из xml-файла.
 - Вы можете дополнить/изменить выгружаемые из Active Directory данные. В шаблоне выгружаются параметры samaccountname для поиска логинов и employeenumber для синхронизации с сотрудниками.